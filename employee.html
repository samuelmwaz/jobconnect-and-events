<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JobConnect - Find & Request Your Next Job</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Custom styles matching the elegant color palette from color pick.jpg */
        body { font-family: 'Inter', sans-serif; background: linear-gradient(135deg, #4B6382 0%, #071739 100%); }
        .card { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
        .card:hover { transform: translateY(-4px); box-shadow: 0 20px 40px rgba(7, 23, 57, 0.3); }
        
        /* Primary Button Colors (Dark Blue to Slate Blue Gradient) */
        .btn-primary { background: linear-gradient(135deg, #071739 0%, #4B6382 100%); box-shadow: 0 4px 12px rgba(7, 23, 57, 0.4); } 
        .btn-primary:hover { background: linear-gradient(135deg, #4B6382 0%, #071739 100%); box-shadow: 0 6px 20px rgba(7, 23, 57, 0.5); }
        
        /* Dashboard Navigation Colors */
        .dashboard-nav a { padding: 12px 16px; border-radius: 10px; margin-bottom: 8px; display: flex; align-items: center; transition: all 0.3s; color: #4B6382; font-weight: 500;}
        .dashboard-nav a:hover { background-color: #CDD5DB; transform: translateX(4px); }
        .dashboard-nav .active { background: linear-gradient(135deg, #A4B5C4 0%, #CDD5DB 100%); color: #071739; font-weight: 600; box-shadow: 0 2px 8px rgba(164, 181, 196, 0.3); } 
        
        /* STATUS PILLS */
        .status-pill-Pending { background: linear-gradient(135deg, #E3C39D 0%, #A68868 100%); color: #071739; box-shadow: 0 2px 8px rgba(166, 136, 104, 0.2); } 
        .status-pill-Viewed { background: linear-gradient(135deg, #CDD5DB 0%, #A4B5C4 100%); color: #071739; box-shadow: 0 2px 8px rgba(164, 181, 196, 0.2); } 
        .status-pill-Contacting { background: linear-gradient(135deg, #A4B5C4 0%, #4B6382 100%); color: white; box-shadow: 0 2px 8px rgba(75, 99, 130, 0.3); }
        
        /* Enhanced card styling */
        .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.3); }
        
        /* Smooth animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.6s ease-out; }
    </style>
</head>
<body class="min-h-screen">

    <header class="bg-white shadow-md">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <a href="#home" class="text-3xl font-bold text-gray-800 tracking-tight">JobConnect</a>
            <nav>
                <button id="auth-button" class="btn-primary text-white px-4 py-2 rounded-lg font-semibold transition shadow-md" onclick="handleAuthClick()">
                    Login / Register
                </button>
            </nav>
        </div>
    </header>

    <main class="container mx-auto p-4 sm:p-6 lg:p-8">
        <div id="app-container">
            </div>
    </main>

    <div id="auth-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 hidden items-center justify-center p-4 z-50">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-sm transform transition-all">
            <h3 class="text-2xl font-bold text-gray-900 mb-4">Select Your Role</h3>
            <p class="text-gray-600 mb-6">Choose your account type to continue to the platform.</p>
            <div class="flex flex-col space-y-4">
                <button class="w-full btn-primary text-white py-3 rounded-lg font-semibold transition" onclick="mockLogin('seeker')">Log in as Job Seeker</button>
                <button class="w-full bg-[#A4B5C4] text-[#071739] py-3 rounded-lg font-semibold hover:bg-[#CDD5DB] transition shadow-md" onclick="mockLogin('employer')">Log in as Employer (TechNova)</button>
                <button class="w-full bg-gray-200 text-gray-800 py-3 rounded-lg font-semibold hover:bg-gray-300 transition" onclick="hideModal('auth-modal')">Cancel</button>
            </div>
        </div>
    </div>

    <div id="request-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 hidden items-center justify-center p-4 z-50">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-md transform transition-all">
            <h3 class="text-2xl font-bold text-gray-900 mb-4">Confirm Job Request</h3>
            <p class="text-gray-600 mb-4">Your current profile and attached resume will be sent to the hiring company for **<span id="job-title-confirm" class="font-semibold text-[#A68868]"></span>**.</p>
            <div class="bg-[#E3C39D] border-l-4 border-[#A68868] p-3 mb-6 rounded-md">
                <p class="text-sm text-[#071739]">Ensure your <a href="#dashboard/profile" onclick="hideModal('request-modal'); navigate('dashboard/profile')" class="underline font-medium">Profile/Resume</a> is up-to-date before sending!</p>
            </div>
            <div class="flex justify-end space-x-3">
                <button class="bg-gray-200 text-gray-800 px-4 py-2 rounded-lg font-semibold hover:bg-gray-300 transition" onclick="hideModal('request-modal')">Cancel</button>
                <button class="bg-[#4B6382] text-white px-4 py-2 rounded-lg font-semibold hover:bg-[#071739] transition shadow-md" onclick="sendRequest()">Send Request Now</button>
            </div>
        </div>
    </div>

    <script>
        // --- MOCK DATA & STATE MANAGEMENT ---
        let isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
        let isEmployer = localStorage.getItem('isEmployer') === 'true'; // New state
        let currentJobId = null;

        // Mock User Data for demonstration
        const mockUser = {
            name: "Alex Johnson",
            profileStatus: 75,
            userId: "JC-98345-AJ",
            lastLogin: new Date().toLocaleDateString(),
            pendingRequests: 3
        };
        
        // Mock Employer Data for demonstration
        const mockEmployerUser = {
            company: "TechNova Solutions",
            id: "EMP-TECH-001"
        };
        
        // --- NEW JOB MANAGEMENT SYSTEM (SHARED WITH EMPLOYER.HTML) ---
        const JOB_STORAGE_KEY = 'globalJobListings';

        // Base/Default Mock Jobs Data (Sectors added for filtering)
        const defaultMockJobs = [
            { id: 101, title: "Senior Frontend Engineer", company: "TechNova Solutions", location: "Remote (Global)", salary: "$120k - $140k", type: "Full-Time", description: "Develop and maintain user-facing features using modern React frameworks and TypeScript. Work closely with design teams to ensure pixel-perfect implementation and responsive design...", posted: "2 days ago", industry: "Software", sector: "ICT" },
            { id: 102, title: "Digital Marketing Specialist", company: "BrightSpark Agency", location: "New York, NY", salary: "$70k - $85k", type: "Full-Time", description: "Manage paid social media campaigns and SEO strategy. Analyze performance data and generate actionable insights to improve conversion rates...", posted: "1 week ago", industry: "Marketing", sector: "ICT" },
            { id: 103, title: "UX Designer", company: "MediFlow Health", location: "Austin, TX", salary: "Competitive", type: "Contract", description: "Design intuitive and accessible user interfaces for our flagship medical record platform. Conduct user research and usability testing...", posted: "3 weeks ago", industry: "Healthcare", sector: "ICT" },
            { id: 104, title: "Financial Reporting Analyst", company: "Zambezi Capital", location: "Lusaka, Zambia", salary: "ZMW 35k - 45k/mo", type: "Full-Time", description: "Lead the quarterly financial analysis and reporting for the Southern Africa region, ensuring compliance with IFRS standards. Requires strong excel and database skills.", posted: "1 day ago", industry: "Finance", sector: "Infrastructure and Construction" },
            { id: 105, title: "Agricultural Logistics Coordinator", company: "AgriSupply Co.", location: "Lusaka, Zambia", salary: "ZMW 18k - 25k/mo", type: "Contract", description: "Coordinate the transport and storage of bulk agricultural commodities across Zambia. Must have experience with local transportation networks.", posted: "4 days ago", industry: "Logistics", sector: "Manufacturing" },
            { id: 106, title: "Mine Safety Officer", company: "Kabwe Copper", location: "Kabwe, Zambia", salary: "ZMW 40k - 50k/mo", type: "Full-Time", description: "Ensure all safety protocols are followed in underground operations.", posted: "1 week ago", industry: "Safety", sector: "Mining" },
            { id: 107, title: "Hydropower Plant Technician", company: "ZESCO", location: "Kariba Dam, Zambia", salary: "ZMW 25k - 35k/mo", type: "Full-Time", description: "Maintain and repair electromechanical equipment at the generation facility.", posted: "2 weeks ago", industry: "Utilities", sector: "Energy" },
            { id: 108, title: "Lodge Manager", company: "Mosi-oa-Tunya Safaris", location: "Livingstone, Zambia", salary: "ZMW 20k - 30k/mo", type: "Full-Time", description: "Oversee daily operations of a luxury safari lodge near Victoria Falls.", posted: "3 days ago", industry: "Hospitality", sector: "Tourism" },
        ];
        
        // Load the job list from LocalStorage, falling back to the default hardcoded list.
        let mockJobs = defaultMockJobs;
        const storedJobs = localStorage.getItem(JOB_STORAGE_KEY);
        
        if (storedJobs) {
             mockJobs = JSON.parse(storedJobs);
        } else {
            // If local storage is empty on the first run, initialize it with the default list
            localStorage.setItem(JOB_STORAGE_KEY, JSON.stringify(defaultMockJobs));
        }
        // --- END JOB MANAGEMENT SYSTEM UPDATE ---


        // NEW Mock Vendor Data
        const mockVendors = [
            { id: 201, name: "Lusaka Feast Catering", category: "Food & Beverage", location: "Lusaka, Zambia", service: "Full-service corporate and event catering.", contact: "LFC-789", posted: "3 weeks ago" },
            { id: 202, name: "Zambia Tech Solutions", category: "Technology", location: "Lusaka, Zambia", service: "IT consulting and hardware supply.", contact: "ZTS-112", posted: "1 month ago" },
            { id: 203, name: "Ndola Safety Gear", category: "Retail", location: "Ndola, Zambia", service: "PPE and industrial safety equipment sales.", contact: "NSG-345", posted: "2 days ago" },
            { id: 204, name: "Kabwe Building Supplies", category: "Construction", location: "Kabwe, Zambia", service: "Cement, steel, and general building materials.", contact: "KBS-678", posted: "1 day ago" },
            { id: 205, name: "Copperbelt Events Planners", category: "Events", location: "Kitwe, Zambia", service: "Event management and decor services.", contact: "CEP-009", posted: "1 week ago" },
            { id: 206, name: "Mazabuka Transport Hub", category: "Transportation", location: "Mazabuka, Zambia", service: "Long-haul logistics and freight services.", contact: "MTH-445", posted: "5 days ago" },
        ];

        // Mock User Requests (updates on application - what the JOB SEEKER sees)
        let mockRequests = JSON.parse(localStorage.getItem('userRequests')) || [
            { id: 501, jobId: 101, title: "Senior Frontend Engineer", company: "TechNova Solutions", date: "2024-10-25", status: "Pending" },
            { id: 502, jobId: 103, title: "UX Designer", company: "MediFlow Health", date: "2024-10-18", status: "Viewed" },
            { id: 503, jobId: 104, title: "Financial Reporting Analyst", company: "Zambezi Capital", date: "2024-10-10", status: "Contacting" }
        ];
        
        // Mock Employer Requests (what the EMPLOYER sees - only for TechNova Solutions in this demo)
        let mockEmployerRequests = JSON.parse(localStorage.getItem('employerRequests')) || [
            { id: 901, applicantName: "Alex Johnson", applicantId: "JC-98345-AJ", jobId: 101, title: "Senior Frontend Engineer", date: "2024-10-25", status: "Pending", resumeScore: 92, match: "High" },
            { id: 902, applicantName: "Beryl Stone", applicantId: "JC-90011-BS", jobId: 101, title: "Senior Frontend Engineer", date: "2024-10-20", status: "Viewed", resumeScore: 78, match: "Medium" },
            { id: 903, applicantName: "Chris Pine", applicantId: "JC-11223-CP", jobId: 101, title: "Senior Frontend Engineer", date: "2024-10-18", status: "Contacting", resumeScore: 95, match: "High" },
            { id: 904, applicantName: "Dana Scully", applicantId: "JC-55555-DS", jobId: 105, title: "Agricultural Logistics Coordinator", date: "2024-10-10", status: "Pending", resumeScore: 88, match: "High" }
        ];

        // --- CORE UI FUNCTIONS (No Change) ---

        function mockLogin(role) {
            isLoggedIn = true;
            isEmployer = role === 'employer';
            localStorage.setItem('isLoggedIn', 'true');
            localStorage.setItem('isEmployer', isEmployer ? 'true' : 'false');
            hideModal('auth-modal');
            navigate(isEmployer ? 'employer/home' : 'dashboard');
            updateAuthButton();
            // Refresh mockJobs on login/role switch to ensure latest data is loaded
            const storedJobs = localStorage.getItem(JOB_STORAGE_KEY);
            if (storedJobs) {
                 mockJobs = JSON.parse(storedJobs);
            }
        }

        function mockLogout() {
            isLoggedIn = false;
            isEmployer = false;
            localStorage.setItem('isLoggedIn', 'false');
            localStorage.setItem('isEmployer', 'false');
            updateAuthButton();
            navigate('home');
        }

        function handleAuthClick() {
            if (isLoggedIn) {
                // If logged in, navigate to the correct dashboard
                navigate(isEmployer ? 'employer/home' : 'dashboard');
            } else {
                // If not logged in, show login modal
                showModal('auth-modal');
            }
        }

        function updateAuthButton() {
            const button = document.getElementById('auth-button');
            if (isLoggedIn) {
                button.textContent = isEmployer ? 'Employer Dashboard' : 'My Dashboard';
                button.classList.remove('btn-primary'); 
                button.classList.add('bg-[#4B6382]', 'hover:bg-[#071739]'); 
            } else {
                button.textContent = 'Login / Register';
                button.classList.remove('bg-[#4B6382]', 'hover:bg-[#071739]');
                button.classList.add('btn-primary');
            }
        }

        function showModal(id) {
            document.getElementById(id).classList.remove('hidden');
            document.getElementById(id).classList.add('flex');
        }

        function hideModal(id) {
            document.getElementById(id).classList.add('hidden');
            document.getElementById(id).classList.remove('flex');
        }

        // --- PAGE RENDERING FUNCTIONS (No Change) ---

        function navigate(hash) {
            window.location.hash = hash.startsWith('#') ? hash.substring(1) : hash;
        }

        function renderPage(pageId) {
            const container = document.getElementById('app-container');
            container.innerHTML = '';
            window.scrollTo(0, 0); // Scroll to top on page change

            // Protected pages logic update
            if (!isLoggedIn && (pageId.startsWith('dashboard') || pageId.startsWith('request') || pageId.startsWith('employer'))) {
                showModal('auth-modal');
                return;
            }

            // Role-based route redirection
            if (isLoggedIn) {
                if (isEmployer && pageId.startsWith('dashboard')) {
                    // Employer trying to access seeker dashboard
                    navigate('employer/home');
                    return;
                }
                if (!isEmployer && pageId.startsWith('employer')) {
                    // Seeker trying to access employer dashboard
                    navigate('dashboard');
                    return;
                }
            }


            switch (pageId.split('/')[0]) {
                case 'job':
                    const id = parseInt(pageId.split('/')[1]);
                    currentJobId = id;
                    renderJobDetails(id);
                    break;
                case 'dashboard':
                    renderDashboard(pageId.split('/')[1] || 'home'); // Job Seeker Dashboard
                    break;
                case 'employer':
                    renderEmployerDashboard(pageId.split('/')[1] || 'home'); // NEW Employer Dashboard
                    break;
                case 'home':
                default:
                    renderHome();
                    break;
            }
        }

        // 1. HOME PAGE RENDER (Updated to include Vendor Search)
        function renderHome() {
            document.getElementById('app-container').innerHTML = `
                <div class="animate-fade-in">
                    <div class="text-center py-16 glass-card rounded-xl shadow-lg mb-8">
                        <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-900 mb-3">Find Your Next Career or Vendor. Connect Directly.</h1>
                        <p class="text-xl text-gray-600 mb-8">Search for job openings or browse our vetted list of marketplace vendors.</p>

                        <div class="max-w-7xl mx-auto p-4">
                            <div class="flex flex-wrap gap-4 items-center justify-center">
                                <input type="text" id="keyword-search" placeholder="Job Title, Keyword, Company, or Vendor Service" class="flex-1 min-w-[200px] p-4 border border-gray-300 rounded-lg focus:ring-[#A68868] focus:border-[#A68868] shadow-sm">
                                
                                <select id="location-select" class="p-4 border border-gray-300 rounded-lg shadow-sm min-w-[150px]">
                                    <option value="">Any Location</option>
                                    <option value="Remote">Remote</option>
                                    <option value="New York">New York, NY</option>
                                    <option value="Austin">Austin, TX</option>
                                    <option value="Lusaka">Lusaka, Zambia</option> 
                                    <option value="Kabwe">Kabwe, Zambia</option>
                                    <option value="Livingstone">Livingstone, Zambia</option>
                                    <option value="Ndola">Ndola, Zambia</option>
                                    <option value="Kitwe">Kitwe, Zambia</option>
                                    <option value="Mazabuka">Mazabuka, Zambia</option>
                                </select>
                                
                                <select id="job-sector-select" class="p-4 border border-gray-300 rounded-lg shadow-sm min-w-[150px]">
                                    <option value="">Any Job Sector</option>
                                    <option value="Mining">Mining</option>
                                    <option value="Energy">Energy</option>
                                    <option value="Manufacturing">Manufacturing</option>
                                    <option value="Infrastructure and Construction">Infrastructure & Construction</option>
                                    <option value="Tourism">Tourism</option>
                                    <option value="ICT">ICT</option>
                                </select>

                                <select id="vendor-category-select" class="p-4 border border-gray-300 rounded-lg shadow-sm min-w-[150px]">
                                    <option value="">Any Vendor Category</option>
                                    <option value="Food & Beverage">Food & Beverage</option>
                                    <option value="Technology">Technology</option>
                                    <option value="Retail">Retail</option>
                                    <option value="Construction">Construction</option>
                                    <option value="Events">Events</option>
                                    <option value="Transportation">Transportation</option>
                                </select>
                                
                                <button onclick="performSearch()" class="btn-primary text-white p-4 rounded-lg font-semibold shadow-md flex-none">
                                    <i data-lucide="search" class="w-5 h-5 mr-2 inline-block"></i> Search
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10 text-center">
                        <div class="p-4 text-center">
                            <i data-lucide="briefcase" class="w-8 h-8 text-[#A68868] mx-auto mb-3"></i>
                            <h3 class="font-semibold text-lg text-gray-900">1. Verified Listings</h3>
                            <p class="text-gray-500 text-sm">We ensure all partners (Employers & Vendors) are verified.</p>
                        </div>
                        <div class="p-4 text-center">
                            <i data-lucide="handshake" class="w-8 h-8 text-[#A68868] mx-auto mb-3"></i>
                            <h3 class="font-semibold text-lg text-gray-900">2. Direct Connection</h3>
                            <p class="text-gray-500 text-sm">Send your resume or vendor inquiry directly to the decision-maker.</p>
                        </div>
                        <div class="p-4 text-center">
                            <i data-lucide="star" class="w-8 h-8 text-[#A68868] mx-auto mb-3"></i>
                            <h3 class="font-semibold text-lg text-gray-900">3. Status Tracking</h3>
                            <p class="text-gray-500 text-sm">Track job requests or manage vendor inquiries easily.</p>
                        </div>
                    </div>

                    <div id="listings-container">
                        <h2 class="text-3xl font-bold text-white mb-6">Featured Vendor Partners</h2>
                        <div id="vendor-list-initial" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-10">
                            ${mockVendors.map(vendor => createVendorCard(vendor)).join('')}
                        </div>
                        <h2 class="text-3xl font-bold text-white mb-6">Featured Job Openings</h2>
                        <div id="job-list-initial" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            ${mockJobs.map(job => createJobCard(job)).join('')}
                        </div>
                    </div>
                </div>
            `;
            lucide.createIcons(); // Initialize icons
        }

        // 2. JOB CARD and DETAILS (No Change)
        function createJobCard(job) {
            return `
                <div class="card glass-card p-6 rounded-xl shadow-md border border-gray-100 cursor-pointer" onclick="navigate('job/${job.id}')">
                    <div class="flex items-center space-x-3 mb-3">
                        <span class="text-xs font-bold text-white bg-[#A68868] px-2 py-1 rounded-full uppercase tracking-wider">Job</span>
                        <span class="text-lg font-bold text-gray-900">${job.title}</span>
                    </div>
                    <p class="text-sm font-semibold text-[#4B6382] mb-2">${job.company}</p>
                    <div class="flex flex-wrap gap-2 text-xs text-gray-600">
                        <span class="flex items-center"><i data-lucide="map-pin" class="w-4 h-4 mr-1 text-gray-400"></i> ${job.location}</span>
                        <span class="flex items-center"><i data-lucide="dollar-sign" class="w-4 h-4 mr-1 text-gray-400"></i> ${job.salary}</span>
                        <span class="flex items-center"><i data-lucide="clock" class="w-4 h-4 mr-1 text-gray-400"></i> ${job.type}</span>
                    </div>
                    <p class="text-sm text-gray-500 mt-3 line-clamp-2">${job.description}</p>
                    <button class="mt-4 text-[#A68868] hover:text-[#071739] font-medium text-sm">View Details &rarr;</button>
                </div>
            `;
        }

        function createVendorCard(vendor) {
            return `
                <div class="card glass-card p-6 rounded-xl shadow-md border border-gray-100 cursor-pointer">
                    <div class="flex items-center space-x-3 mb-3">
                        <span class="text-xs font-bold text-white bg-[#4B6382] px-2 py-1 rounded-full uppercase tracking-wider">Vendor</span>
                        <span class="text-lg font-bold text-gray-900">${vendor.name}</span>
                    </div>
                    <p class="text-sm font-semibold text-[#A68868] mb-2">${vendor.category}</p>
                    <div class="flex flex-wrap gap-2 text-xs text-gray-600">
                        <span class="flex items-center"><i data-lucide="map-pin" class="w-4 h-4 mr-1 text-gray-400"></i> ${vendor.location}</span>
                        <span class="flex items-center"><i data-lucide="calendar" class="w-4 h-4 mr-1 text-gray-400"></i> Active since ${vendor.posted}</span>
                    </div>
                    <p class="text-sm text-gray-500 mt-3 line-clamp-2">${vendor.service}</p>
                    <button class="mt-4 text-[#4B6382] hover:text-[#071739] font-medium text-sm">Inquire Now &rarr;</button>
                </div>
            `;
        }

        function performSearch() {
            const keyword = document.getElementById('keyword-search').value.toLowerCase().trim();
            const location = document.getElementById('location-select').value.trim();
            const jobSector = document.getElementById('job-sector-select').value.trim();
            const vendorCategory = document.getElementById('vendor-category-select').value.trim();
            const listingsContainer = document.getElementById('listings-container');

            // --- Job Filtering Logic ---
            let filteredJobs = mockJobs;

            // 1. Filter Jobs by Location
            if (location) {
                filteredJobs = filteredJobs.filter(job => job.location.includes(location));
            }

            // 2. Filter Jobs by Sector
            if (jobSector) {
                filteredJobs = filteredJobs.filter(job => job.sector === jobSector);
            }

            // 3. Filter Jobs by Keyword (Title or Company or Description)
            if (keyword) {
                filteredJobs = filteredJobs.filter(job => 
                    job.title.toLowerCase().includes(keyword) || 
                    job.company.toLowerCase().includes(keyword) ||
                    job.description.toLowerCase().includes(keyword) 
                );
            }

            // --- Vendor Filtering Logic ---
            let filteredVendors = mockVendors;

            // 1. Filter Vendors by Location
            if (location) {
                filteredVendors = filteredVendors.filter(vendor => vendor.location.includes(location));
            }

            // 2. Filter Vendors by Category
            if (vendorCategory) {
                filteredVendors = filteredVendors.filter(vendor => vendor.category === vendorCategory);
            }

            // 3. Filter Vendors by Keyword (Name or Service)
            if (keyword) {
                filteredVendors = filteredVendors.filter(vendor => 
                    vendor.name.toLowerCase().includes(keyword) || 
                    vendor.service.toLowerCase().includes(keyword)
                );
            }


            // Generate combined results HTML
            const resultsHtml = `
                <div class="md:col-span-2 lg:col-span-3">
                    <h3 class="text-xl font-semibold mb-4 text-white">Search Results for: "${keyword || 'All Listings'}" ${location ? `in ${location}` : ''}</h3>
                </div>

                <div class="md:col-span-2 lg:col-span-3">
                    <h3 class="text-2xl font-bold text-white mb-4 mt-6">Vendor Listings (${filteredVendors.length})</h3>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    ${filteredVendors.map(vendor => createVendorCard(vendor)).join('')}
                    ${filteredVendors.length === 0 ? '<p class="text-gray-300 p-4 col-span-full">No vendor listings found matching your criteria.</p>' : ''}
                </div>

                <div class="md:col-span-2 lg:col-span-3">
                    <h3 class="text-2xl font-bold text-white mb-4 mt-6">Job Listings (${filteredJobs.length})</h3>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    ${filteredJobs.map(job => createJobCard(job)).join('')}
                    ${filteredJobs.length === 0 ? '<p class="text-gray-300 p-4 col-span-full">No job openings found matching your criteria.</p>' : ''}
                </div>
            `;
            
            listingsContainer.innerHTML = resultsHtml;
            lucide.createIcons();
        }

        function renderJobDetails(id) {
            const job = mockJobs.find(j => j.id === id);

            if (!job) {
                document.getElementById('app-container').innerHTML = `<p class="text-white text-center py-10">Job not found.</p>`;
                return;
            }

            document.getElementById('app-container').innerHTML = `
                <div class="animate-fade-in grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2 glass-card p-8 rounded-xl shadow-lg">
                        <h1 class="text-4xl font-extrabold text-gray-900 mb-2">${job.title}</h1>
                        <h2 class="text-2xl font-semibold text-[#A68868] mb-4">${job.company}</h2>
                        
                        <div class="flex flex-wrap gap-4 text-sm text-gray-700 border-b pb-4 mb-6">
                            <span class="flex items-center bg-gray-100 p-2 rounded-full"><i data-lucide="map-pin" class="w-4 h-4 mr-2 text-gray-400"></i> ${job.location}</span>
                            <span class="flex items-center bg-gray-100 p-2 rounded-full"><i data-lucide="dollar-sign" class="w-4 h-4 mr-2 text-gray-400"></i> ${job.salary}</span>
                            <span class="flex items-center bg-gray-100 p-2 rounded-full"><i data-lucide="clock" class="w-4 h-4 mr-2 text-gray-400"></i> ${job.type}</span>
                            <span class="flex items-center bg-gray-100 p-2 rounded-full"><i data-lucide="banknote" class="w-4 h-4 mr-2 text-gray-400"></i>Sector: ${job.sector}</span>
                            <span class="flex items-center bg-gray-100 p-2 rounded-full"><i data-lucide="calendar" class="w-4 h-4 mr-2 text-gray-400"></i>Posted ${job.posted}</span>
                        </div>

                        <div class="prose max-w-none text-gray-700">
                            <h3 class="text-2xl font-bold mt-8 mb-3">Job Summary</h3>
                            <p>${job.description}</p>

                            <h3 class="text-2xl font-bold mt-8 mb-3">Key Responsibilities</h3>
                            <ul class="list-disc list-inside space-y-2 ml-4">
                                <li>Develop and integrate features following best practices.</li>
                                <li>Participate in code reviews and architectural discussions.</li>
                                <li>Collaborate with cross-functional teams (Design, Product).</li>
                                <li>Ensure high performance and responsiveness of the application.</li>
                            </ul>

                            <h3 class="text-2xl font-bold mt-8 mb-3">Qualifications</h3>
                            <ul class="list-disc list-inside space-y-2 ml-4">
                                <li>Bachelor's degree in Computer Science or related field.</li>
                                <li>5+ years of experience in ${job.industry} development.</li>
                                <li>Proficiency in ${job.industry === 'Software' ? 'React, TypeScript, and Tailwind CSS' : 'relevant tools and technologies'}.</li>
                            </ul>
                        </div>
                    </div>

                    <div class="lg:col-span-1">
                        <div class="sticky top-4 bg-gray-50 p-6 rounded-xl border border-gray-200 shadow-inner">
                            <p class="text-xl font-bold text-gray-900 mb-4">Ready to Apply?</p>
                            <p class="text-gray-700 mb-6">Send your profile and resume directly to **${job.company}** with one click. We'll handle the introduction!</p>
                            
                            <button onclick="checkAndShowRequestModal('${job.title}', ${job.id})" class="w-full btn-primary text-white py-3 px-6 rounded-lg font-bold shadow-lg transition">
                                <i data-lucide="send" class="w-5 h-5 mr-2 inline-block"></i> Send Request
                            </button>

                            <p class="mt-4 text-center text-sm text-gray-500">
                                <a href="#home" class="text-[#4B6382] hover:text-[#071739] font-medium">Browse more jobs</a>
                            </p>
                        </div>
                    </div>
                </div>
            `;
            lucide.createIcons();
        }

        function checkAndShowRequestModal(title, jobId) {
            if (!isLoggedIn) {
                alertUser("You must be logged in to send a job request.", 'blue');
                showModal('auth-modal');
                return;
            }
            if (isEmployer) {
                alertUser("Employers cannot request jobs. Please log in as a Job Seeker.", 'red');
                return;
            }

            currentJobId = jobId;
            document.getElementById('job-title-confirm').textContent = title;
            showModal('request-modal');
        }

        function sendRequest() {
            hideModal('request-modal');
            const job = mockJobs.find(j => j.id === currentJobId);

            if (job) {
                // Mock adding to the job seeker's requests list
                const newRequest = {
                    id: Date.now(), 
                    jobId: currentJobId, 
                    title: job.title, 
                    company: job.company, 
                    date: new Date().toLocaleDateString('en-US'), 
                    status: "Pending" 
                };
                mockRequests.unshift(newRequest);
                localStorage.setItem('userRequests', JSON.stringify(mockRequests));
                
                // Mock adding to the employer's requests list (if the employer is TechNova Solutions)
                if (job.company === "TechNova Solutions") {
                    const newEmployerRequest = { id: Date.now() + 1, applicantName: mockUser.name, applicantId: mockUser.userId, jobId: currentJobId, title: job.title, date: new Date().toLocaleDateString('en-US'), status: "Pending", resumeScore: Math.floor(Math.random() * (99 - 70 + 1)) + 70, match: "High" };
                    mockEmployerRequests.unshift(newEmployerRequest);
                    localStorage.setItem('employerRequests', JSON.stringify(mockEmployerRequests));
                }

                // Redirect to dashboard with success message
                navigate('dashboard/requests');
                setTimeout(() => {
                    alertUser(`Success! Your request for "${job.title}" has been sent to ${job.company}.`, 'green');
                }, 50);
            }
        }

        // 3. JOB SEEKER DASHBOARD RENDER (No change)
        function renderDashboard(subPage = 'home') {
            document.getElementById('app-container').innerHTML = `
                <div class="animate-fade-in grid grid-cols-1 lg:grid-cols-4 gap-8">
                    <div class="lg:col-span-1 glass-card p-6 rounded-xl shadow-lg h-min">
                        <div class="text-center mb-6 border-b pb-4">
                            <h3 class="text-xl font-bold text-gray-900">${mockUser.name}</h3>
                            <p class="text-sm text-gray-500">Job Seeker ID: ${mockUser.userId}</p>
                        </div>
                        <nav class="dashboard-nav">
                            <a href="#dashboard/home" class="${subPage === 'home' ? 'active' : ''}" onclick="navigate('dashboard/home')"><i data-lucide="layout-dashboard" class="w-5 h-5 mr-2"></i> Overview</a>
                            <a href="#dashboard/requests" class="${subPage === 'requests' ? 'active' : ''}" onclick="navigate('dashboard/requests')"><i data-lucide="mail-check" class="w-5 h-5 mr-2"></i> My Requests (${mockUser.pendingRequests})</a>
                            <a href="#dashboard/profile" class="${subPage === 'profile' ? 'active' : ''}" onclick="navigate('dashboard/profile')"><i data-lucide="user" class="w-5 h-5 mr-2"></i> Profile & Resume</a>
                            <a href="#" class="text-red-500 hover:bg-red-100" onclick="mockLogout()"><i data-lucide="log-out" class="w-5 h-5 mr-2"></i> Logout</a>
                            <a href="#" class="text-red-500 hover:bg-red-100 mt-4" onclick="confirmDeleteAccount()"><i data-lucide="trash-2" class="w-5 h-5 mr-2"></i> Delete Account</a>
                        </nav>
                    </div>

                    <div class="lg:col-span-3">
                        ${renderDashboardContent(subPage)}
                    </div>
                </div>
            `;
            lucide.createIcons();
        }

        function renderDashboardContent(subPage) {
            switch(subPage) {
                case 'requests':
                    return `
                        <div class="glass-card p-6 rounded-xl shadow-lg">
                            <h3 class="text-2xl font-bold text-gray-900 mb-4">My Job Requests (${mockRequests.length})</h3>
                            <p class="text-gray-600 mb-6">Track the status of your applications sent to various employers.</p>
                            
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead>
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Job Title</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Company</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date Sent</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Link</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white/80 divide-y divide-gray-200">
                                        ${mockRequests.map(req => `
                                            <tr>
                                                <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${req.title}</td>
                                                <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-600">${req.company}</td>
                                                <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-600">${req.date}</td>
                                                <td class="px-4 py-4 whitespace-nowrap">
                                                    <span class="status-pill-${req.status.replace(/\s/g, '')} inline-flex items-center px-3 py-1 text-xs font-semibold rounded-full">${req.status}</span>
                                                </td>
                                                <td class="px-4 py-4 whitespace-nowrap text-sm font-medium">
                                                    <a href="#job/${req.jobId}" class="text-[#A68868] hover:text-[#071739] transition">View Job</a>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                                ${mockRequests.length === 0 ? '<p class="text-center py-6 text-gray-500">You have no active requests. Start searching for jobs!</p>' : ''}
                            </div>
                        </div>
                    `;
                case 'profile':
                    return `
                        <div class="glass-card p-6 rounded-xl shadow-lg">
                            <h3 class="text-xl font-bold mb-4">Profile Completion: ${mockUser.profileStatus}%</h3>
                            <div class="w-full bg-gray-200 rounded-full h-2.5 mb-4">
                                <div class="bg-[#071739] h-2.5 rounded-full" style="width: ${mockUser.profileStatus}%"></div>
                            </div>
                            <p class="text-gray-600 mb-6">Your profile is the resume sent to employers. Keep it updated!</p>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <input type="text" placeholder="Full Name" value="${mockUser.name}" class="p-3 border border-gray-300 rounded-lg">
                                <input type="email" placeholder="Email Address" value="alex@example.com" class="p-3 border border-gray-300 rounded-lg">
                            </div>

                            <textarea placeholder="Professional Summary (500 chars max)" rows="4" class="w-full p-3 border border-gray-300 rounded-lg mt-6">Experienced frontend developer focused on scalable and maintainable UI architecture...</textarea>
                            
                            <h4 class="text-lg font-semibold mt-6 mb-3 border-b pb-2 text-[#071739]">Resume Attachments</h4>
                            <div class="space-y-3">
                                <div class="flex items-center justify-between p-3 bg-gray-100 rounded-lg border border-gray-200">
                                    <span class="text-sm font-medium text-gray-700">Alex_Johnson_Resume_2024.pdf</span>
                                    <button class="text-red-500 hover:text-red-700 text-sm">Remove</button>
                                </div>
                                <div class="flex items-center justify-between p-3 bg-gray-100 rounded-lg border border-gray-200">
                                    <span class="text-sm font-medium text-gray-700">Cover_Letter_TechNova.docx</span>
                                    <button class="text-red-500 hover:text-red-700 text-sm">Remove</button>
                                </div>
                                <input type="file" class="w-full p-3 border border-gray-300 rounded-lg file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-[#A4B5C4] file:text-[#071739] hover:file:bg-[#CDD5DB]"/>
                            </div>

                            <button class="btn-primary text-white py-3 px-6 rounded-lg font-bold mt-6 hover:bg-[#4B6382] transition" onclick="alertUser('Profile details and files saved!', 'green')">Save Profile</button>
                        </div>
                    `;
                case 'home':
                default:
                    return `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div class="glass-card p-6 rounded-xl shadow-lg flex flex-col justify-between">
                                <div>
                                    <h3 class="text-2xl font-bold text-gray-900 mb-4 flex items-center"><i data-lucide="trending-up" class="w-6 h-6 mr-2 text-[#A68868]"></i> Start Your Next Search</h3>
                                    <p class="text-gray-600 mb-6">We currently have **${mockJobs.length}** active job listings from verified employers worldwide.</p>
                                </div>
                                <button onclick="navigate('home')" class="btn-primary text-white py-3 px-6 rounded-lg font-bold hover:bg-[#4B6382] transition shadow-md">Browse Job Listings &rarr;</button>
                            </div>
                            
                            <div class="glass-card p-6 rounded-xl shadow-lg">
                                <h3 class="text-2xl font-bold text-gray-900 mb-4 flex items-center"><i data-lucide="user" class="w-6 h-6 mr-2 text-[#A68868]"></i> Update Profile</h3>
                                <p class="text-gray-600">Your profile is **${mockUser.profileStatus}% complete**. We recommend completing it to increase your chances of getting contacted.</p>
                                <button onclick="navigate('dashboard/profile')" class="mt-4 bg-[#E3C39D] text-[#071739] px-4 py-2 rounded-lg font-semibold hover:bg-[#A68868] hover:text-white transition shadow-md">Complete Profile</button>
                            </div>

                            <div class="md:col-span-2 glass-card p-6 rounded-xl shadow-lg">
                                <h3 class="text-2xl font-bold text-gray-900 mb-4 flex items-center"><i data-lucide="mail-check" class="w-6 h-6 mr-2 text-[#A68868]"></i> Latest Request Status</h3>
                                ${mockRequests.length > 0 ? `
                                    <p class="text-gray-700 mb-2">Your latest request (${mockRequests[0].title}) has status:</p>
                                    <span class="status-pill-${mockRequests[0].status} inline-flex items-center px-4 py-2 text-sm font-semibold rounded-full">${mockRequests[0].status}</span>
                                    <button onclick="navigate('dashboard/requests')" class="ml-4 text-[#A68868] hover:text-[#071739] font-medium">View All Requests &rarr;</button>
                                ` : `<p class="text-gray-500">You haven't sent any requests yet. Time to start searching!</p>`}
                            </div>
                        </div>
                    `;
            }
        }

        // 4. EMPLOYER DASHBOARD RENDER (NEW - Minor updates to pull data based on current state)
        function renderEmployerDashboard(subPage = 'home') {
            // Need to reload the job database on employer dashboard render to ensure accurate postedJobs count
            const allJobs = mockJobs; // mockJobs is already updated via LS logic on initial load/login.
            
            const employerUser = {
                company: "TechNova Solutions",
                postedJobs: allJobs.filter(j => j.company === "TechNova Solutions").length,
                totalRequests: mockEmployerRequests.length,
                interviewing: mockEmployerRequests.filter(r => r.status === "Contacting").length,
                newRequests: mockEmployerRequests.filter(r => r.status === "Pending").length,
            };

            document.getElementById('app-container').innerHTML = `
                <div class="animate-fade-in grid grid-cols-1 lg:grid-cols-4 gap-8">
                    <div class="lg:col-span-1 glass-card p-6 rounded-xl shadow-lg h-min">
                        <div class="text-center mb-6 border-b pb-4">
                            <h3 class="text-xl font-bold text-gray-900">${mockEmployerUser.company}</h3>
                            <p class="text-sm text-gray-500">Employer ID: ${mockEmployerUser.id}</p>
                        </div>
                        <nav class="dashboard-nav">
                            <a href="#employer/home" class="${subPage === 'home' ? 'active' : ''}" onclick="navigate('employer/home')"><i data-lucide="layout-dashboard" class="w-5 h-5 mr-2"></i> Overview</a>
                            <a href="#employer/jobs" class="${subPage === 'jobs' ? 'active' : ''}" onclick="navigate('employer/jobs')"><i data-lucide="briefcase" class="w-5 h-5 mr-2"></i> My Job Listings (${employerUser.postedJobs})</a>
                            <a href="#employer/requests" class="${subPage === 'requests' ? 'active' : ''}" onclick="navigate('employer/requests')"><i data-lucide="mail-check" class="w-5 h-5 mr-2"></i> Candidate Pipeline (${employerUser.newRequests} New)</a>
                            <a href="#employer/settings" class="${subPage === 'settings' ? 'active' : ''}" onclick="navigate('employer/settings')"><i data-lucide="settings" class="w-5 h-5 mr-2"></i> Settings</a>
                            <a href="#" class="text-red-500 hover:bg-red-100 mt-4" onclick="mockLogout()"><i data-lucide="log-out" class="w-5 h-5 mr-2"></i> Logout</a>
                        </nav>
                    </div>

                    <div class="lg:col-span-3">
                        ${renderEmployerDashboardContent(subPage, employerUser)}
                    </div>
                </div>
            `;
            lucide.createIcons();
            // Re-render job lists if on the jobs tab (to pull latest LS data)
            if (subPage === 'jobs' && typeof renderEmployerJobList === 'function') {
                renderEmployerJobList(allJobs);
            }
        }

        // Utility to handle status update from employer view (mock)
        function updateRequestStatus(requestId, newStatus) {
            const requestIndex = mockEmployerRequests.findIndex(req => req.id === requestId);
            if (requestIndex !== -1) {
                mockEmployerRequests[requestIndex].status = newStatus;
                localStorage.setItem('employerRequests', JSON.stringify(mockEmployerRequests));
                // Find corresponding job seeker request and update its status too (mocking server sync)
                const seekerReq = mockRequests.find(req => req.jobId === mockEmployerRequests[requestIndex].jobId && req.title === mockEmployerRequests[requestIndex].title);
                if (seekerReq) {
                    seekerReq.status = newStatus;
                    localStorage.setItem('userRequests', JSON.stringify(mockRequests));
                }
                
                // Re-render the employer dashboard to reflect the change
                navigate('employer/requests'); 
                alertUser(`Status for ${mockEmployerRequests[requestIndex].applicantName} updated to ${newStatus}.`, 'green');
            }
        } 

        function renderEmployerDashboardContent(subPage, employerUser) {
            switch(subPage) {
                case 'requests':
                    return `
                        <div class="glass-card p-6 rounded-xl shadow-lg">
                            <h3 class="text-2xl font-bold text-gray-900 mb-4">Candidate Pipeline Review (${mockEmployerRequests.length} Total)</h3>
                            <p class="text-gray-600 mb-6">Review applicants who have sent direct requests to your job listings.</p>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead>
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Applicant</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Job Applied For</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Match Score</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white/80 divide-y divide-gray-200">
                                        ${mockEmployerRequests.map(req => {
                                            const matchClass = req.match === 'High' ? 'text-green-600 font-semibold' : req.match === 'Medium' ? 'text-yellow-600 font-semibold' : 'text-gray-600';
                                            const statusPillClass = req.status === 'Pending' ? 'status-pill-Pending' : req.status === 'Viewed' ? 'status-pill-Viewed' : 'status-pill-Contacting';

                                            return `
                                                <tr>
                                                    <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${req.applicantName}</td>
                                                    <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-600">${req.title}</td>
                                                    <td class="px-4 py-4 whitespace-nowrap text-sm">
                                                        <span class="${matchClass}">${req.resumeScore}% (${req.match})</span>
                                                    </td>
                                                    <td class="px-4 py-4 whitespace-nowrap">
                                                        <span class="${statusPillClass} inline-flex items-center px-3 py-1 text-xs font-semibold rounded-full">${req.status}</span>
                                                    </td>
                                                    <td class="px-4 py-4 whitespace-nowrap text-sm">
                                                        <div class="flex space-x-2">
                                                            <button class="text-[#4B6382] hover:text-[#071739] font-medium" onclick="alertUser('Simulated opening of resume for ${req.applicantName}', 'blue')">View Profile</button>
                                                            <select onchange="updateRequestStatus(${req.id}, this.value)" class="p-1 border border-gray-300 rounded-lg text-xs">
                                                                <option value="">Update Status</option>
                                                                <option value="Pending" ${req.status === 'Pending' ? 'selected' : ''}>Pending</option>
                                                                <option value="Viewed" ${req.status === 'Viewed' ? 'selected' : ''}>Viewed</option>
                                                                <option value="Contacting" ${req.status === 'Contacting' ? 'selected' : ''}>Contacting</option>
                                                            </select>
                                                        </div>
                                                    </td>
                                                </tr> 
                                            `;
                                        }).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
                case 'jobs':
                    // This is where the jobs management from the modified employer.html would go
                    const allJobs = mockJobs;
                    const employerJobs = allJobs.filter(j => j.company === "TechNova Solutions");

                    return `
                        <div class="glass-card p-6 rounded-xl shadow-lg">
                            <h3 class="text-2xl font-bold text-gray-900 mb-4">Job Listing Management</h3>
                            <p class="text-gray-600 mb-6">Create new job postings for your company, TechNova Solutions.</p>
                            
                            <button onclick="alertUser('Navigate to the main Employer Console page to use the Post New Job form!', 'blue')" class="bg-[#E3C39D] text-[#071739] py-3 px-6 rounded-lg font-bold hover:bg-[#A68868] hover:text-white transition shadow-md mb-6">
                                <i data-lucide="plus" class="w-5 h-5 mr-2 inline-block"></i> Go to Job Posting Form
                            </button>

                            <h4 class="text-xl font-bold text-[#071739] mb-4 border-t pt-4">Currently Active Listings (${employerJobs.length})</h4>
                            <div class="space-y-3">
                                ${employerJobs.map(job => `
                                    <div class="p-4 bg-gray-50 rounded-lg shadow border-l-4 border-[#A68868] flex justify-between items-start">
                                        <div>
                                            <p class="text-lg font-semibold text-[#071739]">${job.title}</p>
                                            <p class="text-sm text-gray-600">Location: ${job.location} | Type: ${job.type}</p>
                                        </div>
                                        <button class="text-sm text-red-500 hover:text-red-700 font-medium ml-4" onclick="alertUser('Simulated job removal for ${job.title}', 'red')">
                                            <i data-lucide="trash-2" class="w-4 h-4 mr-1 inline-block"></i> Remove
                                        </button>
                                    </div>
                                `).join('')}
                                ${employerJobs.length === 0 ? '<p class="text-center py-4 text-gray-500">No active listings. Post a new job!</p>' : ''}
                            </div>
                        </div>
                    `;
                case 'settings':
                    return `
                        <div class="glass-card p-6 rounded-xl shadow-lg">
                            <h3 class="text-2xl font-bold text-gray-900 mb-4">Company Profile Settings</h3>
                            <p class="text-gray-600 mb-6">Manage your company's information and branding.</p>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <input type="text" placeholder="Company Name" value="${mockEmployerUser.company}" class="p-3 border border-gray-300 rounded-lg">
                                <input type="email" placeholder="Contact Email" value="hr@technova.com" class="p-3 border border-gray-300 rounded-lg">
                                <input type="text" placeholder="Location" value="Remote (Global)" class="p-3 border border-gray-300 rounded-lg">
                                <input type="text" placeholder="Industry" value="Software/ICT" class="p-3 border border-gray-300 rounded-lg">
                            </div>

                            <textarea placeholder="Company Description" rows="4" class="w-full p-3 border border-gray-300 rounded-lg mt-6">TechNova Solutions is a leading tech firm dedicated to building scalable enterprise solutions...</textarea>
                            
                            <button class="btn-primary text-white py-3 px-6 rounded-lg font-bold mt-6 hover:bg-[#4B6382] transition" onclick="alertUser('Company details saved!', 'green')">Save Details</button>
                        </div>
                    `;
                case 'home':
                default:
                    return `
                        <div>
                            <h3 class="text-3xl font-bold text-white mb-6">Welcome back, TechNova Solutions Admin!</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                                <div class="card bg-[#071739] text-white p-6 rounded-xl shadow-md">
                                    <p class="text-sm opacity-75">Total Requests</p>
                                    <p class="text-4xl font-bold mt-1">${employerUser.totalRequests}</p>
                                </div>
                                <div class="card bg-[#4B6382] text-white p-6 rounded-xl shadow-md">
                                    <p class="text-sm opacity-75">New Candidates (Pending)</p>
                                    <p class="text-4xl font-bold mt-1">${employerUser.newRequests}</p>
                                </div>
                                <div class="card bg-[#E3C39D] text-[#071739] p-6 rounded-xl shadow-md">
                                    <p class="text-sm opacity-75">Interviewing</p>
                                    <p class="text-4xl font-bold mt-1">${employerUser.interviewing}</p>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="glass-card p-6 rounded-xl shadow-lg">
                                    <h4 class="text-xl font-bold text-gray-900 mb-3 flex items-center"><i data-lucide="briefcase" class="w-5 h-5 mr-2 text-[#A68868]"></i> Job Listings Status</h4>
                                    <p class="text-gray-700">You have **${employerUser.postedJobs}** active job postings.</p>
                                    <button onclick="navigate('employer/jobs')" class="mt-4 bg-[#A4B5C4] text-[#071739] px-4 py-2 rounded-lg font-semibold hover:bg-[#CDD5DB] transition shadow-md">Manage Jobs &rarr;</button>
                                </div>
                                <div class="glass-card p-6 rounded-xl shadow-lg">
                                    <h4 class="text-xl font-bold text-gray-900 mb-3 flex items-center"><i data-lucide="user-plus" class="w-5 h-5 mr-2 text-[#A68868]"></i> Post New Position</h4>
                                    <p class="text-gray-700">Quickly add a new job opening to attract top talent.</p>
                                    <button onclick="alertUser('Navigate to the main Employer Console page to use the Post New Job form!', 'blue')" class="mt-4 bg-[#E3C39D] text-[#071739] px-4 py-2 rounded-lg font-semibold hover:bg-[#A68868] hover:text-white transition shadow-md">Post New Job &rarr;</button>
                                </div>
                            </div>
                        </div>
                    `;
            }
        }

        /**
         * Utility function to display alerts (copied from employer.html for consistency).
         * @param {string} message The message content.
         * @param {string} type 'green' for success, 'red' for error, 'blue' for info.
         */
        function alertUser(message, type) {
            const container = document.getElementById('alert-container');
            if (!container) {
                // Create a container if it doesn't exist (e.g., in employer.html)
                const newContainer = document.createElement('div');
                newContainer.id = 'alert-container';
                newContainer.style.position = 'fixed';
                newContainer.style.top = '1rem';
                newContainer.style.right = '1rem';
                newContainer.style.zIndex = '1000';
                document.body.appendChild(newContainer);
            }
            const actualContainer = document.getElementById('alert-container');

            const alertDiv = document.createElement('div');
            let baseClass = 'p-4 rounded-lg shadow-xl mb-3 flex items-center transition-all duration-300 transform translate-x-0';
            let roleClass = '';

            switch (type) {
                case 'green':
                    roleClass = 'bg-[#CDD5DB] border-[#4B6382] text-[#071739] border-l-4'; 
                    break;
                case 'red':
                    roleClass = 'bg-[#E3C39D] border-[#A68868] text-[#071739] border-l-4'; 
                    break;
                case 'blue':
                    roleClass = 'bg-[#A4B5C4] border-[#4B6382] text-[#071739] border-l-4'; 
                    break;
                default:
                    roleClass = 'bg-gray-100 border-gray-300 text-gray-800 border-l-4';
            }

            alertDiv.className = `${baseClass} ${roleClass}`;
            alertDiv.style.minWidth = '250px';

            alertDiv.innerHTML = `
                <i data-lucide="${type === 'green' ? 'check-circle' : 'alert-triangle'}" class="w-5 h-5 mr-3"></i>
                <p class="font-medium text-sm">${message}</p>
            `;
            actualContainer.appendChild(alertDiv);
            lucide.createIcons();

            setTimeout(() => {
                // Use opacity transition for smooth removal
                alertDiv.classList.add('opacity-0', 'transition', 'duration-500');
                setTimeout(() => alertDiv.remove(), 500);
            }, 5000);
        }

        function confirmDeleteAccount() {
            // In a real app, this would open a confirmation modal.
            // Simplified for the immersive environment.
            alertUser("Account deletion simulated.", 'red');
            mockLogout();
        }


        // --- INITIALIZATION ---
        
        // Router function handles hash changes
        const hashChangeHandler = () => {
            const hash = window.location.hash.substring(1) || 'home';
            renderPage(hash);
            updateAuthButton();
        };

        // Event listeners
        window.addEventListener('hashchange', hashChangeHandler);
        window.onload = () => {
            // Ensure icons are created after dynamic content is added
            lucide.createIcons();
            // Initial render based on URL hash
            hashChangeHandler();
        };

    </script>
</body>
</html>
